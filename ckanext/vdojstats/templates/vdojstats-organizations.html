{% extends "vdojstats-base.html" %}

{% block vdojstat_search %}
  {{ super() }}
    <form class="form-horizontal" method="get" action="{{ action }}" data-module="basic-form">
        
        <p id='search_option_trigger' data-module="search_option_popover"
            {% if c.search %}
                class="icon-minus-sign"
            {% else %}            
                class="icon-plus-sign"
            {% endif %}            
            > 
            Search Options</p>
        <section id='search_option_panel' class="module-content" 
            {% if c.search %}
            {% else %}            
                style='display:none'
            {% endif %}            
        >
        <div class="control-group control-medium">
            <label class="control-label" for="{{_('field-organization')}}">
            {{ _('Organization') }}
            </label>
          <div class="controls ">
            <select id={{_('field-organization')}} multiple name="organization" data-module="">
                {% for option in c.option_org_names  %}
                    <option value="{{ option.value }}" 
                        {% for sel in c.selected_org_names %}
                            {% if option.value == sel %}
                                selected
                            {% endif %}
                        {% endfor %}
                    >
                    {{ option.text or option.value }}</option>
                {% endfor %}
            </select>
        </div><!--controls-->
        </div><!--control-group control-medium-->
        <div class="control-group control-medium">
            <label class="control-label" for="{{_('field-package_state')}}">
            {{ _('Package Status') }}
            </label>
          <div class="controls ">
            <select id={{_('field-package_state')}} multiple name="package_state" data-module="">
                {% for option in c.option_package_states  %}
                    <option value="{{ option.value }}" 
                        {% for sel in c.selected_package_states %}
                            {% if option.value == sel %}
                                selected
                            {% endif %}
                        {% endfor %}
                    >
                    {{ option.text or option.value }}</option>
                {% endfor %}
            </select>
        </div><!--controls-->
        </div><!--control-group control-medium-->
        <div class="control-group control-medium">
            <label class="control-label" for="{{_('field-private')}}">
            {{ _('Publicity') }}
            </label>
          <div class="controls ">
            <label class="radio "><input id="field-private" type="radio" class="private"  name="private[]" value="private" 
              {% if c.private == "private" %}
                checked='checked'
              {% endif %}
            placeholder=""/>{{_('Private')}}</label>
            <label class="radio "><input id="field-private" type="radio" class="private"  name="private[]" value="published" 
              {% if c.private == "published" %}
                checked='checked'
              {% endif %}
            placeholder=""/>{{_('Published')}}</label>
            <label class="radio "><input id="" type="radio" class="private"  name="private[]" value="any" 
              {% if c.private == "any" %}
                checked='checked'
              {% endif %}
            placeholder=""/>{{_('Any')}}</label>
        </div><!--controls-->
        </div><!--control-group control-medium-->
        <div class="control-group control-medium">
            <label class="control-label" for="{{_('field-suspended')}}">
            {{ _('Suspended') }}
            </label>
          <div class="controls ">
            <label class="radio "><input id="field-suspended" type="radio" class="suspended"  name="suspended[]" value="suspended" 
              {% if c.suspended == "suspended" %}
                checked='checked'
              {% endif %}
            placeholder=""/>{{_('Suspended')}}</label>
            <label class="radio "><input id="field-not_suspended" type="radio" class="suspended"  name="suspended[]" value="not_suspended" 
              {% if c.suspended == "not_suspended" %}
                checked='checked'
              {% endif %}
            placeholder=""/>{{_('Not suspended')}}</label>
            <label class="radio "><input id="" type="radio" class="suspended"  name="suspended[]" value="any" 
              {% if c.suspended == "any" %}
                checked='checked'
              {% endif %}
            placeholder=""/>{{_('Any')}}</label>
        </div><!--controls-->
        </div><!--control-group control-medium-->
        <div class="control-group control-medium">
            <label class="control-label" for="{{_('field-pending_approval')}}">
            {{ _('Approval') }}
            </label>
          <div class="controls ">
            <label class="radio "><input id="field-pending_approval" type="radio" class="pending_approval"  name="pending_approval[]" value="pending_approval" 
              {% if c.pending_approval == "pending_approval" %}
                checked='checked'
              {% endif %}
            placeholder=""/>{{_('Pending Approval')}}</label>
            <label class="radio "><input id="field-not_pending_approval" type="radio" class="pending_approval"  name="pending_approval[]" value="not_pending_approval" 
              {% if c.pending_approval == "not_pending_approval" %}
                checked='checked'
              {% endif %}
            placeholder=""/>{{_('Not pending_approval')}}</label>
            <label class="radio "><input id="" type="radio" class="pending_approval"  name="pending_approval[]" value="any" 
              {% if c.pending_approval == "any" %}
                checked='checked'
              {% endif %}
            placeholder=""/>{{_('Any')}}</label>
        </div><!--controls-->
        </div><!--control-group control-medium-->
    <button id="search_form" class="btn btn-primary" type="submit" name="search" value="search_on">Search
    </button>

       </section>
    </form>

{% endblock %}


{% block vdojstat_content %}
  {{ super() }}
{% set truncate = truncate or 180 %}
{% set truncate_title = truncate_title or 80 %}
    <table class="table table-striped table-bordered table-condensed">
        <thead>
          <tr>
            <th scope="col">Organisation</th>
            <th scope="col">Packasge</th>
            <th scope="col">status</th>
            <th scope="col">Private</th>
            <th scope="col">Suspend</th>
            <th scope="col">Suspend Reason</th>
            <th scope="col">Review Date</th>
          </tr>
        </thead>
        <tbody>
          {% for row in c.org_assets %}
              <tr>
                <td class="dataset-label">{{ h.link_to(h.truncate(row.group_title or row.group_name, truncate_title), h.url_for(controller='organization', action='read', id=row.group_name)) }}</td>
                <td class="dataset-details">{{ h.link_to(h.truncate(row.package_title or row.package_name, truncate_title), h.url_for(controller='package', action='read', id=row.package_name)) }}</td>
                <td class="dataset-details">{{ row.package_state }}</td>
                <td class="dataset-details">{{ row.is_private }}</td>
                <td class="dataset-details">{{ row.is_suspended }}</td>
                <td class="dataset-details">{{ row.suspend_reason }}</td>
                <td class="dataset-details">{{ row.next_review_date }}</td>
              </tr>
          {% endfor %}
        </tbody>
    </table>
{% endblock %}


